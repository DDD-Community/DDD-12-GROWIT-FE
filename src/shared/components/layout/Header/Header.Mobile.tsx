'use client';

import { usePathname, useRouter } from 'next/navigation';
import { ChevronLeft } from 'lucide-react';
import Image from 'next/image';
import { HEADER_CONFIG } from './header.config';
import { HeaderMode } from './Header.Desktop';

interface HeaderMobileProps {
  mode?: HeaderMode;
  title?: string;
  rightSection?: React.ReactNode;
}

export const HeaderMobile = ({ mode = 'page', title, rightSection }: HeaderMobileProps) => {
  const pathname = usePathname();
  if (HEADER_CONFIG.hideHeaderPages.includes(pathname as any)) {
    return null;
  }

  const shouldShowBackButton = !HEADER_CONFIG.hideBackButtonPages.includes(pathname as any); // << 여기 고칠 것

  const getPageTitle = () => {
    return HEADER_CONFIG.pageTitles[pathname] || '';
  };

  return (
    <>
      <div className="sm:hidden">
        {mode === 'landing' ? (
          <div className="flex items-center justify-between px-4 py-3">
            <svg width="142" height="20" viewBox="30 0 120 26" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M24.96 9.672C25.088 9.672 25.192 9.72 25.272 9.816C25.368 9.912 25.416 10.024 25.416 10.152V12.528C25.416 14.224 25.08 15.848 24.408 17.4C23.736 18.952 22.832 20.288 21.696 21.408C20.576 22.528 19.224 23.416 17.64 24.072C16.072 24.728 14.424 25.056 12.696 25.056C10.984 25.056 9.344 24.728 7.776 24.072C6.208 23.416 4.856 22.528 3.72 21.408C2.584 20.288 1.68 18.952 1.008 17.4C0.336 15.848 0 14.224 0 12.528C0 10.832 0.336 9.216 1.008 7.68C1.68 6.128 2.584 4.792 3.72 3.672C4.856 2.552 6.208 1.664 7.776 1.008C9.344 0.336 10.992 0 12.72 0C14.752 0 16.648 0.448 18.408 1.344C20.184 2.224 21.656 3.432 22.824 4.968C22.904 5.064 22.936 5.176 22.92 5.304C22.904 5.432 22.848 5.536 22.752 5.616L17.904 9.264C17.808 9.344 17.696 9.376 17.568 9.36C17.44 9.344 17.336 9.28 17.256 9.168C16.728 8.432 16.056 7.856 15.24 7.44C14.424 7.008 13.544 6.792 12.6 6.792C11 6.792 9.632 7.352 8.496 8.472C7.376 9.592 6.816 10.944 6.816 12.528C6.816 14.112 7.376 15.464 8.496 16.584C9.632 17.704 11 18.264 12.6 18.264C13.64 18.264 14.6 18.008 15.48 17.496C16.376 16.968 17.08 16.272 17.592 15.408H11.928C11.8 15.408 11.688 15.36 11.592 15.264C11.496 15.168 11.448 15.056 11.448 14.928V10.152C11.448 10.024 11.496 9.912 11.592 9.816C11.688 9.72 11.8 9.672 11.928 9.672H24.96ZM45.1648 16.128C47.0368 18.256 48.0208 20.96 48.1168 24.24C48.1168 24.368 48.0688 24.48 47.9728 24.576C47.8928 24.672 47.7808 24.72 47.6368 24.72H41.4208C41.2928 24.72 41.1808 24.672 41.0848 24.576C41.0048 24.496 40.9648 24.392 40.9648 24.264C40.8848 22.328 40.3888 20.84 39.4768 19.8C38.5808 18.776 37.3408 18.208 35.7568 18.096V24.24C35.7568 24.368 35.7088 24.48 35.6128 24.576C35.5168 24.672 35.4048 24.72 35.2768 24.72H29.4928C29.3488 24.72 29.2288 24.672 29.1328 24.576C29.0528 24.48 29.0128 24.368 29.0128 24.24V0.840001C29.0128 0.696001 29.0528 0.584001 29.1328 0.504001C29.2288 0.408001 29.3488 0.360001 29.4928 0.360001H40.8688C41.8768 0.360001 42.8048 0.536001 43.6528 0.888C44.5008 1.24 45.2528 1.768 45.9088 2.472C46.5648 3.16 47.0768 4.056 47.4448 5.16C47.8128 6.264 47.9968 7.528 47.9968 8.952C47.9968 12.216 47.0528 14.608 45.1648 16.128ZM35.7568 6.6V11.712C35.7568 11.856 35.8288 11.928 35.9728 11.928H38.7328C39.4368 11.928 40.0208 11.68 40.4848 11.184C40.9648 10.672 41.2048 10 41.2048 9.168C41.2048 8.32 40.9648 7.648 40.4848 7.152C40.0208 6.64 39.4368 6.384 38.7328 6.384H35.9728C35.8288 6.384 35.7568 6.456 35.7568 6.6ZM59.4969 1.008C61.0649 0.336 62.7049 0 64.4169 0C66.1449 0 67.7929 0.336 69.3609 1.008C70.9289 1.664 72.2809 2.552 73.4169 3.672C74.5529 4.792 75.4569 6.128 76.1289 7.68C76.8009 9.216 77.1369 10.832 77.1369 12.528C77.1369 14.224 76.8009 15.848 76.1289 17.4C75.4569 18.952 74.5529 20.288 73.4169 21.408C72.2809 22.528 70.9289 23.416 69.3609 24.072C67.7929 24.728 66.1449 25.056 64.4169 25.056C62.7049 25.056 61.0649 24.728 59.4969 24.072C57.9289 23.416 56.5769 22.528 55.4409 21.408C54.3049 20.288 53.4009 18.952 52.7289 17.4C52.0569 15.848 51.7209 14.224 51.7209 12.528C51.7209 10.832 52.0569 9.216 52.7289 7.68C53.4009 6.128 54.3049 4.792 55.4409 3.672C56.5769 2.552 57.9289 1.664 59.4969 1.008ZM60.3129 16.584C61.4489 17.704 62.8169 18.264 64.4169 18.264C66.0329 18.264 67.4089 17.704 68.5449 16.584C69.6809 15.464 70.2489 14.112 70.2489 12.528C70.2489 10.944 69.6809 9.592 68.5449 8.472C67.4089 7.352 66.0329 6.792 64.4169 6.792C62.8169 6.792 61.4489 7.352 60.3129 8.472C59.1769 9.592 58.6089 10.944 58.6089 12.528C58.6089 14.112 59.1769 15.464 60.3129 16.584ZM97.4179 0.360001C97.6739 0.360001 97.8259 0.480001 97.8739 0.720001L100.706 13.368L102.458 0.768C102.474 0.656001 102.522 0.560001 102.602 0.480001C102.698 0.400001 102.81 0.360001 102.938 0.360001H108.722C108.866 0.360001 108.986 0.416001 109.082 0.528C109.178 0.624 109.21 0.744 109.178 0.888L105.986 23.952C105.97 24.064 105.914 24.16 105.818 24.24C105.738 24.32 105.642 24.36 105.53 24.36H99.1939C99.0659 24.36 98.9619 24.32 98.8819 24.24C98.4659 23.824 98.0259 23.152 97.5619 22.224C97.1139 21.312 96.7059 20.344 96.3379 19.32C95.9699 18.28 95.6339 17.272 95.3299 16.296C95.0259 15.32 94.7939 14.52 94.6339 13.896L94.3939 12.936C94.3299 13.176 94.2419 13.512 94.1299 13.944C94.0179 14.36 93.7859 15.128 93.4339 16.248C93.0979 17.368 92.7619 18.4 92.4259 19.344C92.0899 20.288 91.6819 21.232 91.2019 22.176C90.7379 23.136 90.3059 23.824 89.9059 24.24C89.8259 24.32 89.7139 24.36 89.5699 24.36H83.2579C83.1299 24.36 83.0179 24.32 82.9219 24.24C82.8419 24.16 82.7939 24.064 82.7779 23.952L79.5859 0.888C79.5699 0.744 79.6099 0.624 79.7059 0.528C79.8019 0.416001 79.9219 0.360001 80.0659 0.360001H85.8499C85.9619 0.360001 86.0579 0.400001 86.1379 0.480001C86.2339 0.560001 86.2899 0.656001 86.3059 0.768L88.0819 13.368L90.9139 0.720001C90.9619 0.480001 91.1139 0.360001 91.3699 0.360001H97.4179ZM119.011 24.36H113.227C113.083 24.36 112.963 24.312 112.867 24.216C112.787 24.136 112.747 24.024 112.747 23.88V0.840001C112.747 0.696001 112.787 0.584001 112.867 0.504001C112.963 0.408001 113.083 0.360001 113.227 0.360001H119.011C119.139 0.360001 119.251 0.408001 119.347 0.504001C119.443 0.584001 119.491 0.696001 119.491 0.840001V23.88C119.491 24.024 119.443 24.136 119.347 24.216C119.251 24.312 119.139 24.36 119.011 24.36ZM141.272 0.840001V5.616C141.272 5.744 141.224 5.856 141.128 5.952C141.032 6.032 140.92 6.072 140.792 6.072H135.536V23.88C135.536 24.024 135.488 24.136 135.392 24.216C135.296 24.312 135.184 24.36 135.056 24.36H129.248C129.12 24.36 129.008 24.312 128.912 24.216C128.832 24.136 128.792 24.024 128.792 23.88V6.072H123.536C123.392 6.072 123.272 6.032 123.176 5.952C123.096 5.856 123.056 5.744 123.056 5.616V0.840001C123.056 0.696001 123.096 0.584001 123.176 0.504001C123.272 0.408001 123.392 0.360001 123.536 0.360001H140.792C140.92 0.360001 141.032 0.408001 141.128 0.504001C141.224 0.584001 141.272 0.696001 141.272 0.840001Z"
                fill="white"
              />
            </svg>
            <div className="flex items-center gap-3 min-w-10 h-10">{rightSection}</div>
          </div>
        ) : (
          <div className="flex items-center justify-between px-4 py-3 relative">
            <div className="flex items-center gap-3 min-w-10 h-10">{shouldShowBackButton && <HeaderBackButton />}</div>

            <div className="absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2">
              {mode === 'title' ? (
                <h1 className="text-lg font-semibold text-white">{title || 'Growit'}</h1>
              ) : (
                <h1 className="text-base font-semibold text-white">{getPageTitle()}</h1>
              )}
            </div>

            <div className="flex items-center gap-3 min-w-10 h-10">{rightSection}</div>
          </div>
        )}
      </div>
    </>
  );
};

export const HeaderBackButton = () => {
  const router = useRouter();

  const handleBack = () => {
    router.back();
  };

  return (
    <button
      onClick={handleBack}
      className="flex items-center justify-center w-10 h-10 rounded-lg hover:bg-gray-700 transition-colors"
      aria-label="뒤로가기"
    >
      <ChevronLeft className="w-6 h-6 text-white" />
    </button>
  );
};
